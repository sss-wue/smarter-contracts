<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=fbe70260dbb51a7fcf976742baa34060128f2735">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Smart Contract Vulnerability Detection | Ethereum Smart Contracts Vulnerability Detection using Deep Neural Network and Transfer Learning</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Smart Contract Vulnerability Detection" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ethereum Smart Contracts Vulnerability Detection using Deep Neural Network and Transfer Learning" />
<meta property="og:description" content="Ethereum Smart Contracts Vulnerability Detection using Deep Neural Network and Transfer Learning" />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="Smart Contract Vulnerability Detection" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Smart Contract Vulnerability Detection" />
<script type="application/ld+json">
{"name":"Smart Contract Vulnerability Detection","headline":"Smart Contract Vulnerability Detection","url":"http://localhost:4000/","@type":"WebSite","description":"Ethereum Smart Contracts Vulnerability Detection using Deep Neural Network and Transfer Learning","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          

          <h1 id="project_title">Smart Contract Vulnerability Detection</h1>
          <h2 id="project_tagline">Ethereum Smart Contracts Vulnerability Detection using Deep Neural Network and Transfer Learning</h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <!-- ## Why should we care about Smart Contract Vulnerability? -->
<!--[title](url "Hover title")-->
<p><span style="display:block;text-align:center">
<img src="./assets/images/logo2.png" alt="logo" title="Project Logo" height="400px" />
</span></p>
<h2 id="what-are-smart-contracts">What are Smart Contracts?</h2>

<p>Smart Contracts are computer programs that execute on a blockchain. The nature of blockchains allows one to run Smart Contracts in a trustless and decentralized environment. While different projects implement the concept of Smart Contracts, we concentrate on EVM-based blockchains and use Ethereum as our primary example, as it is the most popular, adopted, and advanced implementation.</p>

<p>At first glance, those Smart Contracts seem rather abstract – code running in a VM on a blockchain. However, they provide the underlying technology in a vast and fast-growing ecosystem of <a href="https://www.theverge.com/22310188/nft-explainer-what-is-blockchain-crypto-art-faq" title="NFTs explained">NFTs</a>, <a href="https://ethereum.org/en/dapps/" title="Ethereum dApps">decentralized applications</a>, and – of course – <a href="https://www.cryptokitties.co/" title="CryptoKitties Website">CryptoKitties</a>. All of those systems have an invested interest of million and even billion dollars. Ethereum itself has a market cap of over 250 billion USD. Furthermore, all of those systems use the fundamental promise of trustless execution, where no trusted 3rd parties are needed to establish trust between two strangers on the Internet.</p>

<p>Generally, Smart Contracts for EVM-compatible blockchains are written in a scripting language and compiled into so-called bytecode. Then, the bytecode is included in the blockchain via a transaction and executed by the miners (or validators in blockchains with stacking-based consensus algorithms). Once the bytecode is on the blockchain, everybody can see the Smart Contract’s bytecode and even issue transactions to execute functionalities of them.</p>

<h3 id="why-should-we-care-about-smart-contract-vulnerabilities">Why should we care about Smart Contract vulnerabilities?</h3>

<p>The inherently public nature of deployed Smart Contracts and the possible financial incentives make Smart Contracts perfect targets for malicious actors. Historically, attackers were successful with their attacks and could steal millions, for example, exploiting the <a href="https://www.gemini.com/cryptopedia/the-dao-hack-makerdao#section-the-dao-hack" title="DAO Hack">DAO contract</a>. Not only that, but vulnerabilities in Smart Contracts undermine the benefits of trustless execution. For example, the other party could plant vulnerabilities in Smart Contracts to exploit them later and invalidate the intent of the Smart Contract to steal money.</p>

<h3 id="why-use-ml-and-transfer-learning">Why use ML and Transfer Learning?</h3>

<p>To detect vulnerabilities in Smart Contracts, researchers and developers proposed many detection tools (<a href="https://github.com/ConsenSys/mythril" title="Mythril GitHub Repository">Mythril</a>, <a href="https://github.com/enzymefinance/oyente" title="Oyente GitHub Repository">Oyente</a>, <a href="https://github.com/nevillegrech/MadMax" title="MadMax GitHub Repository">MadMax</a>, <a href="https://github.com/usyd-blockchain/vandal" title="Vandal GitHub Repository">Vandal</a>, etc.). Most of those tools apply static and dynamic code analysis in addition to fuzzing. While the security community widely adopted those tools, most of them have a substantial execution time of several seconds to minutes. Furthermore, specific tools only allow testing for a subset of potential security issues, which leads to a need to run and test Smart Contracts with multiple different tools. As a result, Smart Contract developers and users would need to deploy, understand and manage several security tools to test for most vulnerability classes.</p>

<p>In recent years classification and labeling of pictures, text, and also malware using Machine Learning arose. As such, the detection of vulnerabilities in Smart Contracts using Machine Learning is the next logical step towards a more secure ecosystem. Furthermore, Machine Learning allows us to speed up the detection processes and combine different tools into one classification process. ML models enable developers and users to test Smart Contract bytecode near-instant without deploying a complex vulnerability detection.</p>

<p>In classical Machine Learning, the training process is bound to a pre-defined set of labels and classes. So, once trained, a Machine Learning model can only detect an unchanging set of vulnerabilities. To alleviate this restriction, we apply the concept of Transfer Learning. Once a model is trained, we can reuse it to modify its labels (i.e., outputs) or even inputs without retraining the entire model. Transfer Learning, therefore, makes the ML model extendable and cuts back at overall training time.</p>

<h2 id="our-work-towards-security-of-smart-contracts">Our Work towards Security of Smart Contracts</h2>

<p>In our work, we demonstrate the effectiveness of Transfer Learning in the domain of Smart Contract vulnerabilities. Specifically, we propose to use Transfer Learning to enable the extensibility of our Machine Learning model in regards to vulnerability classes. Moreover, we show the clear benefit of Transfer Learning by successfully classifying even underrepresented vulnerability classes.</p>

<h3 id="escort-1">ESCORT [1]</h3>

<p>We developed a practical tool-chain to apply Transfer Learning based on vulnerability classes of Smart Contracts in this work. Our high-level execution flow can be seen in this graphic:</p>

<p><span style="display:block;text-align:center">
<img src="./assets/images/overview_escort.png" alt="logo" title="Overview Workflow" width="600px" />
</span></p>

<p>We first label the smart contracts applying different smart contract vulnerability detection tools bundled in our <strong>ContractScraper</strong> – each posses scan capabilities for different vulnerability types. Then, we train, test, and validate our extensible multi-label model with <strong>ESCORT</strong>. Suppose developers find new vulnerabilities or extend the capabilities of current tools at a later point in time. In that case, we can only train on new and underrepresented data to achieve a well-performing model. During deployment, developers can quickly test their smart contracts with <strong>ESCORT</strong>.</p>

<h4 id="contractscraper">ContractScraper</h4>

<p><span style="display:block;text-align:center">
<img src="./assets/images/overview_contractscraper.png" alt="logo" title="Overview ContractScraper" width="600px" />
</span></p>

<p>The high-level flow of <strong>ContractScraper</strong> is straightforward. First, <strong>ContractScraper</strong> extracts the addresses of smart contracts and then their bytecode from the blockchain network. For this task, we included several different APIs, such as <a href="https://infura.io/" title="Infura">Infura</a>, <a href="https://github.com/blockchain-etl/ethereum-etl" title="Ethereum ETL GitHub">Ethereum ETL</a> and <a href="https://contract-library.com/" title="Contract Library by Dedaub">Dedaub’s Contract Library</a>. With the plain bytecode, we scan the bytecode for vulnerabilities using <a href="https://github.com/ConsenSys/mythril" title="Mythril GitHub Repository">Mythril</a>, <a href="https://contract-library.com/" title="Contract Library by Dedaub">Dedaub</a> and <a href="https://github.com/enzymefinance/oyente" title="Oyente GitHub Repository">Oyente</a>. We also already preprocess the bytecode for Machine Learning, applying different rules to prepare the bytecode for inclusion into <strong>ESCORT</strong>.
In total, the bytecode of 1.156.611 Smart Contracts is classified by the three detection tools, allowing us to label Smart Contracts with eight unique vulnerability classes.</p>

<h4 id="escort">ESCORT</h4>

<p><span style="display:block;text-align:center">
<img src="./assets/images/overview_ml.png" alt="logo" title="Overview Escort" width="600px" />
</span></p>

<p>As seen above, our high-level model architecture consists of two parts. The first part is the <em>Feature Extractor</em>. Here, the model learns the fundamental structure of smart contract bytecode. The second part is the <em>Vulnerability Branches</em>. Here, we can extend the model with new vulnerability branches exclusive to a single vulnerability class. We train our model first with six different classes and then use Transfer Learning to extend our model to two additional classes. Here, we achieved a substantially lower inference time of 0.02s, improved training time, and a mean F1-score of 95%. ESCORT can then be used to classify bytecode in an on-the-fly manner.</p>

<h2 id="publications">Publications</h2>
<ul>
  <li>[1] <strong><em>ESCORT: Ethereum Smart COntRacTs Vulnerability Detection using Deep Neural Network and Transfer Learning</em></strong> by Oliver Lutz (University of Würzburg), Huili Chen (<a href="https://sites.google.com/eng.ucsd.edu/huilichen/home">University of California, San-Diego</a>), Hossein Fereidooni (<a href="https://www.informatik.tu-darmstadt.de/systemsecurity/people_sys/people_details_sys_48576.en.jsp">TU Darmstadt</a>), Christoph Sendner (<a href="https://se.informatik.uni-wuerzburg.de/secure-software-systems-group/staff0/christoph-sendner/">University of Würzburg</a>), Alexandra Dmitrienko (<a href="https://se.informatik.uni-wuerzburg.de/secure-software-systems-group/staff0/alexandra-dmitrienko/">University of Würzburg</a>), Ahmad Reza Sadeghi (<a href="https://www.informatik.tu-darmstadt.de/systemsecurity/people_sys/people_details_sys_45184.en.jsp">TU Darmstadt</a>), and Farinaz Koushanfar (<a href="https://farinaz.eng.ucsd.edu/home">University of California, San Diego</a>). Paper available as <strong><a href="https://arxiv.org/pdf/2103.12607.pdf">pre-print</a></strong>.</li>
</ul>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p>Published with love by <a href="http://sss-wue.de">Secure Software Systems Group</a> © 2021</p>
      </footer>
    </div>

    
  </body>
</html>

